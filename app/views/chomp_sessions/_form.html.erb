<%= simple_form_for(chomp_session, data: {controller: "chomp"}) do |f| %>
  <%= f.input :name, label:"Meeting Name", required: false,
    placeholder: "I can't decide on a name on #{Time.now}",
    input_html: { value: f.object.name || [
    "Chomping since #{Time.now}",
    "Nom nom time",
    "Chomp chomp time",
    "Indecisive Gang",
    "CafÃ© Hoppers",
    "Just need somewhere to shake my legs and wag my tongue",
    "I can't decide on a name",
    "What is life?",
    "Anything la", "Whatever la",
    "Can Chomp decide on a name for me, please?",
    "Turtles are cute",
    "Cats > Dogs",
    "Dogs > Cats"
    ].sample } %>
  <%= f.input :date, html5: true, min: "#{Date.today.iso8601}"%>
  <%= f.input :time, html5: true, min: "#{Time.now.iso8601}" %>
  <%= f.input :session_expiry, label:"Link Expiry Time (Hours)", hint: "Set the time that you want your poll to be active" %>
  <%# <%= f.input :invitees, label:"Number of Friends (optional)", placeholder:"Optional" %>

  <label class="integer optional mb-3" for="chomp_session_invitees">Number of Friends (optional)</label>
  <div class="flex-between">
    <a class="round-bordered incrementer minus" data-offset="-1">-</a>
    <span id="counter" data-chomp-target="total">1</span>
    <a href="#" class="round-bordered incrementer" type="button" data-action="click->chomp#increment">+</a>
  </div>

  <div class="form-group integer optional chomp_session_invitees">
    <input type="number" class="form-control numeric integer optional" placeholder="Optional" step="1" name="chomp_session[invitees]" id="chomp_session_invitees" value="1">
    <p id="restriction" data-chomp-target="alert">In light of current...</p>
  </div>



  <%= f.submit value:"Create Invite Link", class:"btn btn-primary btn-block" %>
<% end %>


<script>

  var updateCounter = (counter, count) => {
    counter.dataset.count = count;
    counter.innerText = count;
  };

  var updateInput = (count) => {
    let input = document.getElementById('chomp_session_invitees');
    input.value = count;
  };


  var updateForm = (event) => {
    //converting string to integer from clicking on the plus and minus signs
    let offset = Number.parseInt(event.currentTarget.dataset.offset, 10);
    let counter = document.getElementById('counter');
    let count = Number.parseInt(counter.dataset.count, 10) + offset;
    if (count <= 2) {
      event.preventDefault();
      updateCounter(counter, count);
      updateInput(count);

    } else {
      event.preventDefault();
      // alert("In light of current COVID-19 restrictions, dine-in has been capped at 2.");
    }
  };

  var updateFormOnButtonClick = (button) => {
    button.addEventListener('click', updateForm);
  };

  var buttons = document.querySelectorAll('.incrementer');
  buttons.forEach(updateFormOnButtonClick);
</script>
